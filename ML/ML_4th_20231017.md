## Classifier(이진분류)에서의 K-NN

## Regressor(다중분류)에서의 K-NN

# 군집 알고리즘
- Clustering(군집화): 주어진 데이터로부터 특징 값이 유사한 데이터를 묶는 것
- Clustering 방법에는 K-means, H-clustering, DBSCAN 등이 있음
- 데이터에 레이블이 없는 것이 특징
- 비지도학습에는 K-means, H-clustering, DBSCAN, PCA, Auto-encoder 등이 있음. 레이블이 없는 데이터에서 특징을 파악해 일정한 규칙을 찾아내는 러닝머신 기법
- (예) 데이터만 존재하고 기사에 대한 분류가 존재하지 않는 경우
- 좋은 군집화? 군집 사이의 거리는 멀게, 내부 데이터 사이의 거리는 가깝게 하는 것이 좋은 군집화

## (1) k-means clustering
- 주어진 데이터를 k개의 클러스터로 묶는 비지도 학습 알고리즘
- 데이터의 특징만으로 비슷한 데이터끼리 모아 군집화된 클래스로 분류
- 1.데이터의 시각화(scatter plot)를 통해, 또는 Elbow 그래프를 그려서, 사전에 k값/중심점을 설정해줘야 함. 각각의 클러스터마다 중심점이 존재함. 그 중심점의 수가 k개라는 의미. k값/중심점 위치는 랜덤하게 설정됨.
- 2. 각 중심점과 모든 데이터 사이의 거리를 모두 구한다. 각 중심점 중에서 데이터와 가장 가까운 중심점이 무엇인가를 찾아서, 그 중심점 그룹에 속하는 데이터로 분류함. 유클리디안 거리 공식이 사용됨. 먼저 정규화 또는 표준화를 한 후 거리를 구한다.
- 3. 클러스터에 속하는 데이터들의 평균 점의 위치를 계산하여 알아낸 좌표로 중심점이 이동한다.
- 4. 중심점의 위치가 변경되지 않을 때 까지, 2~3번 단계를 계속 반복한다. 
- 초기 k값을 몇개로 할 것인가, 중심점을 어디로 할 것인가에 따라 모델이 다양하게 나오게 됨. 이 과정이 중요함.
- k값/최초 중심 설정 방법: 무작위설정, 사용자가 직접 설정, k-means++의 방법이 있음
- 무작위설정: 실행할 때 마다 군집화가 다르게 나타난다
- 사용자 직접 설정: 시각화를 해서 중심점을 찍어줘야 함. 나의 의도대로 설정하는 것
- k-means 알고리즘의 장점: 간단한 알고리즘으로 구현이 용이, 계산시간이 비교적 짧음
- k-means 알고리즘의 단점: 초기 클러스터 개수와 중심에 따라 결과가 크게 달라질 수 있고, 결과 해석이 쉽지 않음



## (2) k-means++
중심점을 좀 더 효과적으로 설정할 수 있도록 개선된 알고리즘. 랜덤하게 한 데이터를 정해서 중심점을 설정한다. 평면상의 위치 중 가장 멀리 떨어져 있는 데이터를 두번째 중심점으로 설정. 다시 두 중심점과 가장 멀리 떨어져 있는 점을 세번째 중심점으로 설정. 그 이후의 과정은 기존 k-means와 동일

## (3) H-clustering
- 계층적 군집화. 계층적 트리 모형을 이용해 개별 개체들을 순차적, 계층적으로 유사한(거리가 가장 가까운) 그룹과 통합하여 군집화를 수행하는 알고리즘
-덴드로그램 시각화를 이용해 군집의 개수를 결정한다. 덴드로그램(Dendrogram)? 표본들이 군을 형성하는 과정을 나타내는 나무 형식의 그림. 몇 개의 군집으로 나눌 것인지를 결정하기 위해 덴드로그램을 그린다. 
- 전체 데이터 n개 중, 가장 가까운 데이터를 연결(군집). 데이터 수가 n-1개가 됨. 다시 가장 가까운 데이터를 연결(군집). 데이터 수가 n-2가 됨... 마지막에 한 개의 군집이 될 때 까지 연결.
- 군집화 방식: 군집을 구성하는 데이터 중 어떤 데이터를 기준으로 거리를 계산하는 지의 방식.
- 단일기준결합방식(single linkage 또는 mean 방식): 각각의 군집의 경계에서 다른 군집 경계에 가장 가까운 데이터를 기준으로 거리 계산. 
- 완전기준결합방식(complete linkage 또는 max 방식): 각각의 군집에서 가장 멀리 떨어진 데이터를 기준으로 거리를 계산.
- 평균기준결합방식(average linkage) : 군집 내의 모든 점을 다른 군집의 점들과의 거리를 계산하고 평균을 구한다. 
- 중심연결법(centroid linkage): 각 군집의 딱 중앙에 있는 점들(centroids) 사이의 거리를 구함.
- 평균기준결합방식이 합리적이긴 하나, 데이터가 많아지면 거리를 구할 때 시간이 많이 소요되는 단점이 있음

## (4) DBSCAN (밀도 기반/밀집 기반 군집화 알고리즘)
- 비선형구조의 데이터에 적합한 알고리즘. 선이 아닌 곡선, 포물선 구조의 데이터에 적합. k-means를 쓸 수 없는 데이터에 적합한 알고리즘
- 데이터 중에서 밀도가 가장 높은 데이터끼리 군집화 한다
- 먼저 면적을 구해서, 단위 면적당 데이터의 개수를 구해야 한다.
- 점이 많이 몰려있는 쪽이 밀도가 높다고 보고, 그 부분을 먼저 군집화하는 방식이다.
- 기준점을 먼저 잡고, 특정 반경 이내에서 사전에 정한 개수 만큼의 데이터를 군집으로 형성하는 방식
- 기준점으로부터 사전에 설정한 반경(epsilon) 이내에 포함되어야 할 점의 개수(사전에 설정. minpoints)만큼 군집을 인식하는 방법. 이때 그 개수를 만족한다면, 이 기준점이 core point가 된다. 만족하지 못하다면 core point가 될 수 없음. 이때의 기준점은 경계점(Boarder point)라고 함.
- 한 반경 이내에 두 개 이상의 core point가 존재한다면, 해당 군집들이 하나로 합쳐지게 된다. 
- 기준점이 반경 이내에 속한 데이터가 없고, 또 자신이 다른 군집에도 속하지 않는 경우, 이런 기준점을 noise point라고 부름. 이상치임.
- DBSCAN은 이상치를 발견하는 데에도 유용함



